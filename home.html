<html>
  <div class="topnav">
    <a class="active" href="index.html">JSON to CSV</a>
    <a href="home.html">Octoparse Link Generator</a>
  </div>

  <div style="padding: 20px 0 0 20px; font-size: 24px">
    <label for="link">Yellowpages Category</label>
    <input size="50" type="text" id="link" />
    <br />
    <label for="provinces">Yellowpages Province</label>
    <select name="provinces" id="provinces">
      <option value="AB">Alberta</option>
      <option value="BC">British Columbia</option>
      <option value="MB">Manitoba</option>
      <option value="NB">New Brunswick</option>
      <option value="NL">Newfoundland And Labrador</option>
      <option value="NS">Nova Scotia</option>
      <option value="ON">Ontario</option>
      <option value="PE">Prince Edward Island</option>
      <option value="QC">Quebec</option>
      <option value="SK">Saskatchewan</option>
      <option value="NT">Northwest Territories</option>
      <option value="NU">Nunavut</option>
      <option value="YT">Yukon</option>
    </select>
    <button onclick="generateLinks()">Go!</button>
    <br />
    <input type="radio" name="size" value="10" id="10" checked />
    <label for="10">Small</label>
    <input type="radio" name="size" value="30" id="30" />
    <label for="30">Medium</label>
    <input type="radio" name="size" value="60" id="60" />
    <label for="60">Large</label>
    <br />
    <button onclick="copyDivToClipboard()">Copy to Clipboard!</button>
  </div>

  <p id="output"></p>

  <script>
    function generateLinks() {
      var prov = document.getElementById("provinces");
      var provValue = prov.value;
      var provText = prov.options[prov.selectedIndex].text;
      var category = document.getElementById("link").value;

      var size = document.querySelector('input[name="size"]:checked').value;
      console.log(size);

      var outputDiv = document.getElementById("output");
      outputDiv.innerText = "";

      for (let i = 0; i <= 25; i++) {
        for (let j = 1; j <= size; j++) {
          outputDiv.innerText +=
            "https://www.yellowpages.ca/search/si/" +
            j +
            "/" +
            category +
            "/" +
            provText.replace(/\s/g, "+") +
            "+" +
            provValue +
            "?sortby=alph&rfn=rfl-" +
            String.fromCharCode(65 + i) +
            "\r\n";
        }
      }
    }

    function copyDivToClipboard() {
      var range = document.createRange();
      range.selectNode(document.getElementById("output"));
      window.getSelection().removeAllRanges(); // clear current selection
      window.getSelection().addRange(range); // to select text
      document.execCommand("copy");
      window.getSelection().removeAllRanges(); // to deselect
    }
  </script>
</html>

<style>
  * {
    margin: 0;
    padding: 0;
  }
  .topnav {
    background-color: #333;
    overflow: hidden;
  }

  /* Style the links inside the navigation bar */
  .topnav a {
    float: left;
    color: #f2f2f2;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
    font-size: 17px;
  }

  /* Change the color of links on hover */
  .topnav a:hover {
    background-color: #ddd;
    color: black;
  }

  /* Add a color to the active/current link */
  .topnav a.active {
    background-color: #04aa6d;
    color: white;
  }
</style>
